---
# =============================================================================
# DNS Configuration Tasks
# =============================================================================

- name: Configure resolv.conf
  ansible.builtin.template:
    src: network/resolv.conf.j2
    dest: /etc/resolv.conf
    mode: "0644"
  when: network_config.dns is defined
  tags: ["network", "dns"]

- name: Configure hosts file
  ansible.builtin.template:
    src: network/hosts.j2
    dest: /etc/hosts
    mode: "0644"
  when: network_config.hosts is defined
  tags: ["network", "dns"]

- name: Configure hostname
  ansible.builtin.hostname:
    name: "{{ network_config.hostname }}"
  when: network_config.hostname is defined
  tags: ["network", "dns"]

- name: Update hostname in /etc/hosts
  ansible.builtin.lineinfile:
    path: /etc/hosts
    regexp: "^127.0.1.1"
    line: "127.0.1.1 {{ network_config.hostname }}"
  when: network_config.hostname is defined
  tags: ["network", "dns"]
